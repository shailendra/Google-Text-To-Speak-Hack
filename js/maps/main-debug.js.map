{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["(function() {\r\n\t//---------------------------------------------------------------------\r\n\t//---------------------------------------------------------------------\r\n\tvar HangoutHack = function() {\t\r\n\t\tthis.initialize();\r\n\t}\r\n\tvar p = HangoutHack.prototype;\r\n\t\r\n\t//---  V A R I A B L E S  -------------------------------------------------\r\n\tp.body;\r\n\tp.isIFrame;\r\n\t//---------------------------------------------------------------------\r\n\tp.initialize = function() {\r\n        var This = this;\r\n        this.body = document.querySelector(\"body\");\r\n        this.synth = window.speechSynthesis;\r\n\r\n\r\n       \r\n        //--------------------------------------------------\r\n        if ( window.location !== window.parent.location ) {\r\n            //--- may be hangout\r\n            this.isIFrame = true;\r\n            this.setupHangout();\r\n        } else {\r\n            this.isIFrame = false;\r\n            this.setupMouseUp();\r\n        }\r\n\r\n        if (this.synth.onvoiceschanged !== undefined) {\r\n            this.synth.onvoiceschanged = function(){\r\n                This.setVoices();\r\n            };\r\n        }\r\n        this.setVoices();\r\n       // this.setupOnBodyModify();\r\n    }\r\n    p.setVoices = function(){\r\n        this.voices = this.synth.getVoices();\r\n        this.femaleVoice = this.voices[9];\r\n        this.maleVoice = this.voices[5];\r\n    }\r\n    p.setupMouseUp = function(){\r\n        var This = this;\r\n        this.body.addEventListener(\"mouseup\",function(e){\r\n            if (e.shiftKey) {     \r\n                var text = window.getSelection().toString();  \r\n                if(text && text!=\"\"){\r\n                    \r\n                    This.speak({text:text})\r\n                }\r\n            }\r\n        })\r\n    }\r\n    p.speak = function (prop){\r\n        if (this.synth.speaking) {\r\n            this.synth.cancel();\r\n        }\r\n        if (prop.text !== '') {\r\n        var utterThis = new SpeechSynthesisUtterance(prop.text);\r\n        utterThis.onend = function (event) {\r\n            //console.log('SpeechSynthesisUtterance.onend');\r\n        }\r\n        utterThis.onerror = function (event) {\r\n            //console.error('SpeechSynthesisUtterance.onerror');\r\n        }\r\n        var pitch = 1;\r\n        var rate = 1;\r\n        if(prop.gender!=undefined){   \r\n            if(prop.gender==\"M\"){\r\n                utterThis.voice = this.maleVoice;\r\n                rate = 0.9;\r\n            } else{                \r\n                utterThis.voice = this.femaleVoice;\r\n                rate = 0.8;\r\n            }\r\n        }else{            \r\n            utterThis.voice = this.femaleVoice;\r\n            rate = 0.8;\r\n        }\r\n        utterThis.pitch = pitch;\r\n        utterThis.rate = rate;\r\n        this.synth.speak(utterThis);\r\n    }\r\n    } \r\n    p.setupOnBodyModify = function(){\r\n        var This = this;\r\n        this.body.addEventListener(\"DOMNodeInserted\",function(e){\r\n            var iframes = e.target.querySelectorAll(\"iframe\");\r\n            if(iframes.length>0){\r\n                This.onHangoutIframeLoad({iframe:iframes[0]});\r\n            }\r\n        });\r\n    }\r\n    p.setupHangout = function(){        \r\n        this.body = document.querySelector(\"body\");\r\n        var This = this;\r\n        this.body.addEventListener(\"click\",function(e, b){\r\n            var chatArray = This.body.querySelectorAll(\".TmwRj\"); \r\n            var clickCloseChat = e.target.closest(\".TmwRj\");\r\n            if(clickCloseChat!=null){   \r\n                for (let i = 0; i < chatArray.length; i++) {\r\n                    const element = chatArray[i];\r\n                    if (element.innerHTML === clickCloseChat.innerHTML){\r\n                        This.speakSingleHangoutMessage(element);\r\n                    }\r\n                }             \r\n            }\r\n        },false);\r\n    }\r\n\tp.speakSingleHangoutMessage = function(element){\r\n        var span = element.querySelectorAll(\".KL span:not([aria-hidden='true'])\");\r\n        var textSp = \"\";\r\n        for(var i = 0; i<span.length; i++ ){\r\n            var tempSpan = span[i];\r\n            textSp+=tempSpan.innerText+\" \";\r\n        }\r\n        this.speak({text:textSp, gender:\"F\"});\r\n\t}\r\n\t//---------------------------------------------------------------------\r\n\twindow.HangoutHack = HangoutHack;\r\n}());\r\nvar hangoutHack =  new window.HangoutHack();\r\n\r\n\r\n"],"file":"../main-debug.js"}